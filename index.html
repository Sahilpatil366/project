<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cybersecurity Toolkit</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #3b82f6;
      --primary-dark: #2563eb;
      --danger: #ef4444;
      --warning: #f59e0b;
      --success: #10b981;
      --dark: #1f2937;
      --darker: #111827;
      --light: #f3f4f6;
      --gray: #9ca3af;
      --border-radius: 8px;
      --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: var(--darker);
      color: var(--light);
      line-height: 1.6;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    header {
      background: var(--dark);
      padding: 15px 0;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: var(--box-shadow);
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo h1 {
      font-size: 1.5rem;
      font-weight: 600;
    }

    .logo i {
      font-size: 1.8rem;
      color: var(--primary);
    }

    nav {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    nav button {
      padding: 10px 15px;
      background: rgba(59, 130, 246, 0.1);
      color: var(--primary);
      border: 1px solid var(--primary);
      border-radius: var(--border-radius);
      cursor: pointer;
      font-weight: 500;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    nav button:hover {
      background: var(--primary);
      color: white;
    }

    nav button.active {
      background: var(--primary);
      color: white;
    }

    nav button i {
      font-size: 1rem;
    }

    main {
      padding: 30px 0;
    }

    .section {
      display: none;
      background: var(--dark);
      border-radius: var(--border-radius);
      padding: 25px;
      box-shadow: var(--box-shadow);
      margin-bottom: 30px;
      animation: fadeIn 0.5s ease-out;
    }

    .section.active {
      display: block;
    }

    .section-header {
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section-header h2 {
      color: var(--primary);
      font-size: 1.5rem;
    }

    .section-header i {
      font-size: 1.5rem;
      color: var(--primary);
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--light);
    }

    input, textarea, select {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #374151;
      border-radius: var(--border-radius);
      background: #1f2937;
      color: var(--light);
      font-size: 1rem;
      transition: var(--transition);
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }

    textarea {
      min-height: 150px;
      resize: vertical;
    }

    button {
      padding: 12px 20px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    button:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
    }

    button i {
      font-size: 1rem;
    }

    .btn-group {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .btn-secondary {
      background: rgba(59, 130, 246, 0.1);
      color: var(--primary);
      border: 1px solid var(--primary);
    }

    .btn-secondary:hover {
      background: var(--primary);
      color: white;
    }

    .btn-danger {
      background: var(--danger);
    }

    .btn-danger:hover {
      background: #dc2626;
    }

    .btn-success {
      background: var(--success);
    }

    .btn-success:hover {
      background: #059669;
    }

    .result {
      margin-top: 20px;
      padding: 15px;
      border-radius: var(--border-radius);
      font-weight: 500;
      display: none;
    }

    .result.show {
      display: block;
      animation: fadeIn 0.5s ease-out;
    }

    .result-danger {
      background: rgba(239, 68, 68, 0.1);
      border-left: 4px solid var(--danger);
      color: var(--danger);
    }

    .result-warning {
      background: rgba(245, 158, 11, 0.1);
      border-left: 4px solid var(--warning);
      color: var(--warning);
    }

    .result-success {
      background: rgba(16, 185, 129, 0.1);
      border-left: 4px solid var(--success);
      color: var(--success);
    }

    .result-info {
      background: rgba(59, 130, 246, 0.1);
      border-left: 4px solid var(--primary);
      color: var(--primary);
    }

    .password-strength-meter {
      height: 5px;
      background: #374151;
      border-radius: 5px;
      margin-top: 10px;
      overflow: hidden;
    }

    .password-strength-meter-fill {
      height: 100%;
      width: 0%;
      transition: width 0.3s ease;
    }

    .password-tips {
      margin-top: 20px;
      padding: 15px;
      background: rgba(59, 130, 246, 0.1);
      border-radius: var(--border-radius);
      font-size: 0.9rem;
    }

    .password-tips h3 {
      margin-bottom: 10px;
      color: var(--primary);
    }

    .password-tips ul {
      padding-left: 20px;
    }

    .password-tips li {
      margin-bottom: 5px;
    }

    .tooltip {
      position: relative;
      display: inline-block;
      margin-left: 5px;
      cursor: pointer;
    }

    .tooltip i {
      color: var(--gray);
      font-size: 0.9rem;
    }

    .tooltip-text {
      visibility: hidden;
      width: 200px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 8px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 0.8rem;
      font-weight: normal;
    }

    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .feature-card {
      background: var(--dark);
      border-radius: var(--border-radius);
      padding: 20px;
      box-shadow: var(--box-shadow);
      transition: var(--transition);
    }

    .feature-card:hover {
      transform: translateY(-5px);
    }

    .feature-card i {
      font-size: 2rem;
      color: var(--primary);
      margin-bottom: 15px;
    }

    .feature-card h3 {
      margin-bottom: 10px;
      color: var(--primary);
    }

    .feature-card p {
      font-size: 0.9rem;
      color: var(--gray);
    }

    /* Permission Analyzer Styles */
    .permission-list {
      margin-top: 15px;
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid #374151;
      border-radius: var(--border-radius);
      padding: 10px;
    }
    
    .permission-item {
      display: flex;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid #374151;
    }
    
    .permission-item:last-child {
      border-bottom: none;
    }
    
    .permission-item input[type="checkbox"] {
      margin-right: 10px;
    }
    
    .permission-category {
      margin-top: 20px;
      color: var(--primary);
      font-weight: 500;
    }
    
    .permission-risk {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 0.8rem;
      margin-left: 10px;
    }
    
    .risk-low {
      background-color: rgba(16, 185, 129, 0.2);
      color: var(--success);
    }
    
    .risk-medium {
      background-color: rgba(245, 158, 11, 0.2);
      color: var(--warning);
    }
    
    .risk-high {
      background-color: rgba(239, 68, 68, 0.2);
      color: var(--danger);
    }
    
    .quick-select {
      margin: 15px 0;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .quick-select button {
      padding: 8px 12px;
      font-size: 0.8rem;
    }

    footer {
      background: var(--dark);
      padding: 20px 0;
      text-align: center;
      margin-top: 50px;
    }

    footer p {
      color: var(--gray);
      font-size: 0.9rem;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        gap: 15px;
      }

      nav {
        width: 100%;
        justify-content: center;
      }

      nav button {
        flex: 1;
        min-width: 120px;
        justify-content: center;
      }
      
      .btn-group {
        flex-direction: column;
      }
      
      .quick-select {
        flex-direction: column;
      }
      
      .quick-select button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <i class="fas fa-shield-alt"></i>
          <h1>Cybersecurity Toolkit</h1>
        </div>
        <nav>
          <button class="active" onclick="showSection('password')">
            <i class="fas fa-key"></i> Password
          </button>
          <button onclick="showSection('phishing')">
            <i class="fas fa-fish"></i> Phishing
          </button>
          <button onclick="showSection('login')">
            <i class="fas fa-user-lock"></i> Login
          </button>
          <button onclick="showSection('url')">
            <i class="fas fa-link"></i> URL
          </button>
          <button onclick="showSection('permissions')">
            <i class="fas fa-mobile-alt"></i> App Permissions
          </button>
          <button onclick="showSection('info')">
            <i class="fas fa-info-circle"></i> Info
          </button>
        </nav>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Password Strength Checker -->
    <div class="section active" id="password">
      <div class="section-header">
        <i class="fas fa-key"></i>
        <h2>Password Strength Checker</h2>
      </div>
      
      <div class="form-group">
        <label for="passwordInput">
          Enter your password
          <span class="tooltip">
            <i class="fas fa-question-circle"></i>
            <span class="tooltip-text">We never store or transmit your password. All checks happen in your browser.</span>
          </span>
        </label>
        <input type="password" id="passwordInput" placeholder="Type your password..." />
        <div class="password-strength-meter">
          <div class="password-strength-meter-fill" id="passwordStrengthMeter"></div>
        </div>
      </div>
      
      <div class="btn-group">
        <button onclick="checkPassword()">
          <i class="fas fa-check"></i> Check Strength
        </button>
        <button class="btn-secondary" onclick="clearInput('passwordInput')">
          <i class="fas fa-trash"></i> Clear
        </button>
      </div>
      
      <div class="result" id="passwordResult"></div>
      
      <div class="password-tips">
        <h3><i class="fas fa-lightbulb"></i> Password Tips</h3>
        <ul>
          <li>Use at least 12 characters</li>
          <li>Include uppercase and lowercase letters</li>
          <li>Add numbers and special characters</li>
          <li>Avoid common words and personal information</li>
          <li>Consider using a passphrase (e.g., "CorrectHorseBatteryStaple")</li>
        </ul>
      </div>
    </div>

    <!-- Phishing Email Detector -->
    <div class="section" id="phishing">
      <div class="section-header">
        <i class="fas fa-fish"></i>
        <h2>Phishing Email Detector</h2>
      </div>
      
      <div class="form-group">
        <label for="emailInput">Paste suspicious email content</label>
        <textarea id="emailInput" placeholder="Paste the email content you want to analyze here..."></textarea>
      </div>
      
      <div class="btn-group">
        <button onclick="checkPhishing()">
          <i class="fas fa-search"></i> Analyze Email
        </button>
        <button class="btn-secondary" onclick="clearInput('emailInput')">
          <i class="fas fa-trash"></i> Clear
        </button>
      </div>
      
      <div class="result" id="phishingResult"></div>
      
      <div class="form-group">
        <label>Common phishing indicators:</label>
        <ul style="padding-left: 20px; color: var(--gray); font-size: 0.9rem;">
          <li>Urgent or threatening language</li>
          <li>Requests for personal information</li>
          <li>Suspicious sender addresses</li>
          <li>Generic greetings ("Dear Customer")</li>
          <li>Mismatched links (hover to check actual URL)</li>
          <li>Poor spelling and grammar</li>
        </ul>
      </div>
    </div>

    <!-- Suspicious Login Detector -->
    <div class="section" id="login">
      <div class="section-header">
        <i class="fas fa-user-lock"></i>
        <h2>Suspicious Login Checker</h2>
      </div>
      
      <div class="form-group">
        <label for="location">Login Location</label>
        <input type="text" id="location" placeholder="e.g., Russia, Unknown, VPN" />
      </div>
      
      <div class="form-group">
        <label for="device">Device Information</label>
        <input type="text" id="device" placeholder="e.g., unknown device, new device" />
      </div>
      
      <div class="form-group">
        <label for="time">Unusual Login Time?</label>
        <select id="time">
          <option value="no">No</option>
          <option value="yes">Yes</option>
        </select>
      </div>
      
      <div class="btn-group">
        <button onclick="checkLogin()">
          <i class="fas fa-shield-alt"></i> Check Login
        </button>
        <button class="btn-secondary" onclick="clearLoginInputs()">
          <i class="fas fa-trash"></i> Clear All
        </button>
      </div>
      
      <div class="result" id="loginResult"></div>
    </div>

    <!-- Malware URL Classifier -->
    <div class="section" id="url">
      <div class="section-header">
        <i class="fas fa-link"></i>
        <h2>Malware URL Classifier</h2>
      </div>
      
      <div class="form-group">
        <label for="urlInput">Enter URL to check</label>
        <input type="text" id="urlInput" placeholder="e.g., http://example.com" />
      </div>
      
      <div class="btn-group">
        <button onclick="checkURL()">
          <i class="fas fa-search"></i> Check URL
        </button>
        <button class="btn-secondary" onclick="clearInput('urlInput')">
          <i class="fas fa-trash"></i> Clear
        </button>
      </div>
      
      <div class="result" id="urlResult"></div>
      
      <div class="form-group">
        <label>Common malicious URL patterns:</label>
        <ul style="padding-left: 20px; color: var(--gray); font-size: 0.9rem;">
          <li>Misspellings of popular sites (e.g., "facebok.com")</li>
          <li>Unusual domain extensions (.ru, .tk, .xyz)</li>
          <li>Long strings of random characters</li>
          <li>URLs with IP addresses instead of domain names</li>
          <li>HTTPS missing (look for padlock icon)</li>
        </ul>
      </div>
    </div>

    <!-- Mobile App Permission Analyzer -->
    <div class="section" id="permissions">
      <div class="section-header">
        <i class="fas fa-mobile-alt"></i>
        <h2>Mobile App Permission Analyzer</h2>
      </div>
      
      <p style="margin-bottom: 15px;">
        Select the permissions requested by an Android app to assess its potential risk level.
      </p>
      
      <div class="quick-select">
        <button onclick="selectAllPermissions()">
          <i class="fas fa-check-square"></i> Select All
        </button>
        <button onclick="clearAllPermissions()">
          <i class="fas fa-square"></i> Clear All
        </button>
        <button onclick="selectCommonSafe()">
          <i class="fas fa-thumbs-up"></i> Common Safe
        </button>
        <button onclick="selectCommonRisky()">
          <i class="fas fa-exclamation-triangle"></i> Common Risky
        </button>
      </div>
      
      <div class="form-group">
        <label>Select Permissions:</label>
        <div class="permission-list" id="permissionList">
          <!-- Permissions will be added here by JavaScript -->
        </div>
      </div>
      
      <div class="btn-group">
        <button onclick="analyzePermissions()">
          <i class="fas fa-search"></i> Analyze Permissions
        </button>
        <button class="btn-secondary" onclick="clearAllPermissions()">
          <i class="fas fa-trash"></i> Clear All
        </button>
      </div>
      
      <div class="result" id="permissionResult"></div>
      
      <div class="password-tips">
        <h3><i class="fas fa-lightbulb"></i> Permission Risk Guide</h3>
        <ul>
          <li><span class="risk-high">High Risk</span>: Can access sensitive data or system functions</li>
          <li><span class="risk-medium">Medium Risk</span>: Potentially concerning depending on app purpose</li>
          <li><span class="risk-low">Low Risk</span>: Generally safe for most apps</li>
          <li>More permissions don't always mean higher risk - consider the app's purpose</li>
          <li>Be especially cautious with financial, health, or social media apps</li>
        </ul>
      </div>
    </div>

    <!-- Information Section -->
    <div class="section" id="info">
      <div class="section-header">
        <i class="fas fa-info-circle"></i>
        <h2>About Cybersecurity Toolkit</h2>
      </div>
      
      <p style="margin-bottom: 20px;">
        This toolkit helps you identify common cybersecurity threats. All analysis happens locally in your browser - no data is sent to any server.
      </p>
      
      <div class="features-grid">
        <div class="feature-card">
          <i class="fas fa-key"></i>
          <h3>Password Checker</h3>
          <p>Evaluate your password strength and get tips for creating stronger passwords.</p>
        </div>
        
        <div class="feature-card">
          <i class="fas fa-fish"></i>
          <h3>Phishing Detector</h3>
          <p>Analyze email content for common phishing tactics and suspicious indicators.</p>
        </div>
        
        <div class="feature-card">
          <i class="fas fa-user-lock"></i>
          <h3>Login Checker</h3>
          <p>Assess whether a login attempt might be suspicious based on location and device.</p>
        </div>
        
        <div class="feature-card">
          <i class="fas fa-link"></i>
          <h3>URL Classifier</h3>
          <p>Check URLs for common patterns associated with malicious websites.</p>
        </div>
        
        <div class="feature-card">
          <i class="fas fa-mobile-alt"></i>
          <h3>App Permissions</h3>
          <p>Analyze Android app permissions to assess potential security risks.</p>
        </div>
      </div>
      
      <div style="margin-top: 30px; padding: 20px; background: rgba(59, 130, 246, 0.1); border-radius: var(--border-radius);">
        <h3 style="margin-bottom: 15px; color: var(--primary);"><i class="fas fa-shield-alt"></i> General Security Tips</h3>
        <ul style="padding-left: 20px;">
          <li style="margin-bottom: 10px;">Use a password manager to generate and store strong, unique passwords</li>
          <li style="margin-bottom: 10px;">Enable two-factor authentication (2FA) wherever possible</li>
          <li style="margin-bottom: 10px;">Keep your software and operating system updated</li>
          <li style="margin-bottom: 10px;">Be skeptical of unsolicited communications asking for information</li>
          <li style="margin-bottom: 10px;">Regularly review your account activity and permissions</li>
          <li style="margin-bottom: 10px;">Review app permissions before installation and remove unused apps</li>
        </ul>
      </div>
    </div>
  </main>

  <footer>
    <div class="container">
      <p><i class="fas fa-code"></i> with <i class="fas fa-heart" style="color: #ef4444;"></i> by Cybersecurity Toolkit</p>
      <p style="margin-top: 5px; font-size: 0.8rem;">All processing happens locally in your browser - no data is collected or stored.</p>
    </div>
  </footer>

  <script>
    // DOM elements
    const passwordInput = document.getElementById('passwordInput');
    const passwordResult = document.getElementById('passwordResult');
    const passwordStrengthMeter = document.getElementById('passwordStrengthMeter');
    const emailInput = document.getElementById('emailInput');
    const phishingResult = document.getElementById('phishingResult');
    const locationInput = document.getElementById('location');
    const deviceInput = document.getElementById('device');
    const timeInput = document.getElementById('time');
    const loginResult = document.getElementById('loginResult');
    const urlInput = document.getElementById('urlInput');
    const urlResult = document.getElementById('urlResult');
    const permissionResult = document.getElementById('permissionResult');

    // Permission datasets
    const permissionDatasets = {
      categories: {
        location: ["ACCESS_FINE_LOCATION", "ACCESS_COARSE_LOCATION", "ACCESS_BACKGROUND_LOCATION"],
        storage: ["READ_EXTERNAL_STORAGE", "WRITE_EXTERNAL_STORAGE", "MANAGE_EXTERNAL_STORAGE"],
        camera: ["CAMERA"],
        microphone: ["RECORD_AUDIO"],
        contacts: ["READ_CONTACTS", "WRITE_CONTACTS", "GET_ACCOUNTS"],
        phone: ["READ_PHONE_STATE", "CALL_PHONE", "READ_CALL_LOG", "WRITE_CALL_LOG"],
        sms: ["SEND_SMS", "RECEIVE_SMS", "READ_SMS"],
        calendar: ["READ_CALENDAR", "WRITE_CALENDAR"],
        sensors: ["BODY_SENSORS"],
        network: ["ACCESS_WIFI_STATE", "CHANGE_WIFI_STATE", "INTERNET"],
        system: ["REQUEST_INSTALL_PACKAGES", "SYSTEM_ALERT_WINDOW", "WRITE_SETTINGS"]
      },
      
      riskLevels: {
        high: [
          "ACCESS_BACKGROUND_LOCATION",
          "MANAGE_EXTERNAL_STORAGE",
          "READ_CONTACTS",
          "READ_CALL_LOG",
          "WRITE_CALL_LOG",
          "SEND_SMS",
          "RECEIVE_SMS",
          "READ_SMS",
          "BODY_SENSORS",
          "REQUEST_INSTALL_PACKAGES",
          "SYSTEM_ALERT_WINDOW"
        ],
        
        medium: [
          "ACCESS_FINE_LOCATION",
          "ACCESS_COARSE_LOCATION",
          "WRITE_EXTERNAL_STORAGE",
          "CAMERA",
          "RECORD_AUDIO",
          "WRITE_CONTACTS",
          "GET_ACCOUNTS",
          "READ_PHONE_STATE",
          "CALL_PHONE",
          "READ_CALENDAR",
          "WRITE_CALENDAR",
          "WRITE_SETTINGS"
        ],
        
        low: [
          "READ_EXTERNAL_STORAGE",
          "ACCESS_WIFI_STATE",
          "CHANGE_WIFI_STATE",
          "INTERNET"
        ]
      },
      
      commonSets: {
        safe: ["INTERNET", "ACCESS_WIFI_STATE", "READ_EXTERNAL_STORAGE"],
        risky: [
          "ACCESS_FINE_LOCATION",
          "READ_CONTACTS",
          "READ_SMS",
          "CAMERA",
          "RECORD_AUDIO"
        ]
      }
    };

    // Show section function
    function showSection(id) {
      // Hide all sections
      document.querySelectorAll('.section').forEach(sec => {
        sec.classList.remove('active');
      });
      
      // Show selected section
      document.getElementById(id).classList.add('active');
      
      // Update active nav button
      document.querySelectorAll('nav button').forEach(btn => {
        btn.classList.remove('active');
      });
      event.currentTarget.classList.add('active');
      
      // Reset inputs when switching sections
      resetResults();
    }

    // Reset result displays
    function resetResults() {
      passwordResult.classList.remove('show');
      phishingResult.classList.remove('show');
      loginResult.classList.remove('show');
      urlResult.classList.remove('show');
      permissionResult.classList.remove('show');
    }

    // Clear input field
    function clearInput(inputId) {
      document.getElementById(inputId).value = '';
      resetResults();
      
      // Special handling for password strength meter
      if (inputId === 'passwordInput') {
        passwordStrengthMeter.style.width = '0%';
      }
    }

    // Clear all login inputs
    function clearLoginInputs() {
      locationInput.value = '';
      deviceInput.value = '';
      timeInput.value = 'no';
      resetResults();
    }

    // Password strength checker
    function checkPassword() {
      const pwd = passwordInput.value;
      let strength = 0;
      let messages = [];
      
      // Length check
      if (pwd.length >= 12) strength += 2;
      else if (pwd.length >= 8) strength += 1;
      else messages.push("Too short (min 8 chars)");
      
      // Character variety checks
      if (/[A-Z]/.test(pwd)) strength += 1;
      else messages.push("Add uppercase letters");
      
      if (/[a-z]/.test(pwd)) strength += 1;
      
      if (/[0-9]/.test(pwd)) strength += 1;
      else messages.push("Add numbers");
      
      if (/[^A-Za-z0-9]/.test(pwd)) strength += 2;
      else messages.push("Add special characters");
      
      // Common password check
      const commonPasswords = ["password", "123456", "qwerty", "letmein", "welcome"];
      if (commonPasswords.some(word => pwd.toLowerCase().includes(word))) {
        strength = Math.max(0, strength - 2);
        messages.push("Avoid common words");
      }
      
      // Update strength meter
      let meterWidth = 0;
      let resultClass = "";
      let resultText = "";
      
      if (strength <= 3) {
        meterWidth = 25;
        resultClass = "result-danger";
        resultText = "Weak Password";
      } else if (strength <= 5) {
        meterWidth = 50;
        resultClass = "result-warning";
        resultText = "Moderate Password";
      } else if (strength <= 7) {
        meterWidth = 75;
        resultClass = "result-success";
        resultText = "Strong Password";
      } else {
        meterWidth = 100;
        resultClass = "result-success";
        resultText = "Very Strong Password!";
      }
      
      passwordStrengthMeter.style.width = meterWidth + "%";
      passwordStrengthMeter.style.backgroundColor = getMeterColor(meterWidth);
      
      // Add improvement suggestions if any
      if (messages.length > 0 && strength < 8) {
        resultText += " - Improve by: " + messages.join(", ");
      }
      
      // Show result
      passwordResult.className = "result show " + resultClass;
      passwordResult.innerHTML = `<i class="fas fa-${strength >= 6 ? 'check-circle' : 'exclamation-triangle'}"></i> ${resultText}`;
    }

    // Get color for password strength meter
    function getMeterColor(width) {
      if (width <= 25) return "#ef4444";
      if (width <= 50) return "#f59e0b";
      if (width <= 75) return "#84cc16";
      return "#10b981";
    }

    // Real-time password strength feedback
    passwordInput.addEventListener('input', function() {
      if (this.value.length > 0) {
        checkPassword();
      } else {
        passwordStrengthMeter.style.width = "0%";
        passwordResult.classList.remove('show');
      }
    });

    // Phishing email detector
    function checkPhishing() {
      const email = emailInput.value.toLowerCase();
      if (!email.trim()) {
        phishingResult.className = "result show result-info";
        phishingResult.innerHTML = '<i class="fas fa-info-circle"></i> Please enter email content to analyze';
        return;
      }
      
      const phishingKeywords = [
        { term: "urgent", weight: 2 },
        { term: "click here", weight: 3 },
        { term: "verify", weight: 2 },
        { term: "reset password", weight: 3 },
        { term: "bank", weight: 2 },
        { term: "account", weight: 1 },
        { term: "login", weight: 2 },
        { term: "dear customer", weight: 1 },
        { term: "suspended", weight: 2 },
        { term: "action required", weight: 2 },
        { term: "limited time", weight: 1 },
        { term: "unusual activity", weight: 2 },
        { term: "security alert", weight: 2 },
        { term: "confirm your identity", weight: 3 }
      ];
      
      let score = 0;
      const foundTerms = [];
      
      phishingKeywords.forEach(item => {
        if (email.includes(item.term)) {
          score += item.weight;
          foundTerms.push(item.term);
        }
      });
      
      // Check for suspicious links
      const linkMatches = email.match(/https?:\/\/[^\s]+/g) || [];
      const suspiciousLinks = linkMatches.filter(link => {
        return link.includes('.ru') || link.includes('.tk') || 
               link.includes('.xyz') || link.includes('.top') ||
               link.match(/https?:\/\/\d+\.\d+\.\d+\.\d+/);
      });
      
      if (suspiciousLinks.length > 0) {
        score += suspiciousLinks.length * 2;
        foundTerms.push(...suspiciousLinks.map(link => "suspicious link: " + link.substring(0, 30) + (link.length > 30 ? "..." : "")));
      }
      
      // Determine result
      let resultClass, resultText;
      
      if (score === 0) {
        resultClass = "result-success";
        resultText = '<i class="fas fa-check-circle"></i> No significant phishing indicators found';
      } else if (score <= 3) {
        resultClass = "result-info";
        resultText = `<i class="fas fa-info-circle"></i> Some suspicious elements: ${foundTerms.slice(0, 3).join(", ")}`;
      } else if (score <= 6) {
        resultClass = "result-warning";
        resultText = `<i class="fas fa-exclamation-triangle"></i> Likely phishing attempt. Indicators: ${foundTerms.slice(0, 5).join(", ")}`;
      } else {
        resultClass = "result-danger";
        resultText = `<i class="fas fa-skull-crossbones"></i> High probability of phishing! Indicators: ${foundTerms.slice(0, 7).join(", ")}`;
      }
      
      phishingResult.className = "result show " + resultClass;
      phishingResult.innerHTML = resultText;
    }

    // Suspicious login detector
    function checkLogin() {
      const location = locationInput.value.toLowerCase();
      const device = deviceInput.value.toLowerCase();
      const unusualTime = timeInput.value === "yes";
      
      if (!location.trim() || !device.trim()) {
        loginResult.className = "result show result-info";
        loginResult.innerHTML = '<i class="fas fa-info-circle"></i> Please enter location and device info';
        return;
      }
      
      const riskyLocations = ["unknown", "vpn", "proxy", "tor", "russia", "china", "nigeria"];
      const riskyDevices = ["unknown", "new", "unrecognized", "emulator", "virtual"];
      
      let score = 0;
      const indicators = [];
      
      // Check location
      if (riskyLocations.some(word => location.includes(word))) {
        score += 2;
        indicators.push("risky location");
      }
      
      // Check device
      if (riskyDevices.some(word => device.includes(word))) {
        score += 2;
        indicators.push("unusual device");
      }
      
      // Check time
      if (unusualTime) {
        score += 1;
        indicators.push("unusual time");
      }
      
      // Determine result
      let resultClass, resultText;
      
      if (score === 0) {
        resultClass = "result-success";
        resultText = '<i class="fas fa-check-circle"></i> Login appears normal';
      } else if (score <= 2) {
        resultClass = "result-info";
        resultText = `<i class="fas fa-info-circle"></i> Somewhat suspicious: ${indicators.join(", ")}`;
      } else if (score <= 4) {
        resultClass = "result-warning";
        resultText = `<i class="fas fa-exclamation-triangle"></i> Suspicious login: ${indicators.join(", ")}`;
      } else {
        resultClass = "result-danger";
        resultText = `<i class="fas fa-skull-crossbones"></i> Highly suspicious login! ${indicators.join(", ")} - consider changing your password`;
      }
      
      loginResult.className = "result show " + resultClass;
      loginResult.innerHTML = resultText;
    }

    // URL classifier
    function checkURL() {
      const url = urlInput.value.toLowerCase();
      if (!url.trim()) {
        urlResult.className = "result show result-info";
        urlResult.innerHTML = '<i class="fas fa-info-circle"></i> Please enter a URL to analyze';
        return;
      }
      
      // Basic URL validation
      if (!url.match(/^https?:\/\/.+/)) {
        urlResult.className = "result show result-danger";
        urlResult.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Invalid URL format - should start with http:// or https://';
        return;
      }
      
      const suspiciousPatterns = [
        { pattern: /\.ru$|\.tk$|\.xyz$|\.top$|\.gq$/, weight: 2 },
        { pattern: /free|gift|prize|win|reward/, weight: 1 },
        { pattern: /login|signin|verify|account/, weight: 2 },
        { pattern: /download|install|update/, weight: 1 },
        { pattern: /\d+\.\d+\.\d+\.\d+/, weight: 3 }, // IP address
        { pattern: /[^\w]bitcoin|crypto|wallet/, weight: 1 },
        { pattern: /[^\w]bank|paypal|credit/, weight: 2 },
        { pattern: /[^\w]pharmacy|viagra|cialis/, weight: 3 }
      ];
      
      let score = 0;
      const foundPatterns = [];
      
      suspiciousPatterns.forEach(item => {
        if (url.match(item.pattern)) {
          score += item.weight;
          const match = url.match(item.pattern)[0];
          foundPatterns.push(match.length > 15 ? match.substring(0, 15) + "..." : match);
        }
      });
      
      // Check for URL shortening services
      const shorteners = ["bit.ly", "goo.gl", "tinyurl", "ow.ly", "t.co"];
      if (shorteners.some(service => url.includes(service))) {
        score += 2;
        foundPatterns.push("URL shortener");
      }
      
      // Check for misspellings of popular domains
      const popularDomains = ["google", "facebook", "amazon", "apple", "microsoft"];
      popularDomains.forEach(domain => {
        if (url.includes(domain) && !url.includes(domain + ".com")) {
          score += 3;
          foundPatterns.push("possible " + domain + " impersonation");
        }
      });
      
      // Determine result
      let resultClass, resultText;
      
      if (score === 0) {
        resultClass = "result-success";
        resultText = '<i class="fas fa-check-circle"></i> URL appears safe';
      } else if (score <= 3) {
        resultClass = "result-info";
        resultText = `<i class="fas fa-info-circle"></i> Some suspicious elements: ${foundPatterns.slice(0, 3).join(", ")}`;
      } else if (score <= 6) {
        resultClass = "result-warning";
        resultText = `<i class="fas fa-exclamation-triangle"></i> Suspicious URL: ${foundPatterns.slice(0, 5).join(", ")}`;
      } else {
        resultClass = "result-danger";
        resultText = `<i class="fas fa-skull-crossbones"></i> Dangerous URL! ${foundPatterns.slice(0, 7).join(", ")} - do not visit`;
      }
      
      urlResult.className = "result show " + resultClass;
      urlResult.innerHTML = resultText;
    }

    // Initialize permission analyzer
    function initPermissionAnalyzer() {
      const permissionList = document.getElementById('permissionList');
      permissionList.innerHTML = '';
      
      // Add all permissions organized by category
      for (const [category, permissions] of Object.entries(permissionDatasets.categories)) {
        const categoryEl = document.createElement('div');
        categoryEl.className = 'permission-category';
        categoryEl.textContent = category.charAt(0).toUpperCase() + category.slice(1) + ' Permissions:';
        permissionList.appendChild(categoryEl);
        
        permissions.forEach(permission => {
          const riskLevel = getPermissionRiskLevel(permission);
          
          const itemEl = document.createElement('div');
          itemEl.className = 'permission-item';
          
          itemEl.innerHTML = `
            <input type="checkbox" id="perm_${permission}" name="permissions" value="${permission}">
            <label for="perm_${permission}">${permission}</label>
            <span class="permission-risk risk-${riskLevel}">${riskLevel}</span>
          `;
          
          permissionList.appendChild(itemEl);
        });
      }
    }
    
    // Get risk level for a permission
    function getPermissionRiskLevel(permission) {
      if (permissionDatasets.riskLevels.high.includes(permission)) return 'high';
      if (permissionDatasets.riskLevels.medium.includes(permission)) return 'medium';
      return 'low';
    }
    
    // Select all permissions
    function selectAllPermissions() {
      document.querySelectorAll('#permissionList input[type="checkbox"]').forEach(checkbox => {
        checkbox.checked = true;
      });
    }
    
    // Clear all permissions
    function clearAllPermissions() {
      document.querySelectorAll('#permissionList input[type="checkbox"]').forEach(checkbox => {
        checkbox.checked = false;
      });
      permissionResult.classList.remove('show');
    }
    
    // Select common safe permissions
    function selectCommonSafe() {
      clearAllPermissions();
      permissionDatasets.commonSets.safe.forEach(permission => {
        const checkbox = document.getElementById(`perm_${permission}`);
        if (checkbox) checkbox.checked = true;
      });
    }
    
    // Select common risky permissions
    function selectCommonRisky() {
      clearAllPermissions();
      permissionDatasets.commonSets.risky.forEach(permission => {
        const checkbox = document.getElementById(`perm_${permission}`);
        if (checkbox) checkbox.checked = true;
      });
    }
    
    // Analyze selected permissions
    function analyzePermissions() {
      const selectedPermissions = Array.from(
        document.querySelectorAll('#permissionList input[type="checkbox"]:checked')
      ).map(checkbox => checkbox.value);
      
      if (selectedPermissions.length === 0) {
        const resultEl = document.getElementById('permissionResult');
        resultEl.className = "result show result-info";
        resultEl.innerHTML = '<i class="fas fa-info-circle"></i> Please select at least one permission';
        return;
      }
      
      // Calculate risk score
      let riskScore = 0;
      let highRiskCount = 0;
      let mediumRiskCount = 0;
      let lowRiskCount = 0;
      
      selectedPermissions.forEach(permission => {
        const riskLevel = getPermissionRiskLevel(permission);
        
        if (riskLevel === 'high') {
          riskScore += 3;
          highRiskCount++;
        } else if (riskLevel === 'medium') {
          riskScore += 1.5;
          mediumRiskCount++;
        } else {
          riskScore += 0.5;
          lowRiskCount++;
        }
      });
      
      // Normalize score (0-100)
      const maxPossibleScore = (selectedPermissions.length * 3);
      const normalizedScore = Math.min(100, Math.round((riskScore / maxPossibleScore) * 100));
      
      // Determine risk level
      let riskLevel, resultClass;
      
      if (normalizedScore >= 70) {
        riskLevel = "High Risk";
        resultClass = "result-danger";
      } else if (normalizedScore >= 40) {
        riskLevel = "Medium Risk";
        resultClass = "result-warning";
      } else {
        riskLevel = "Low Risk";
        resultClass = "result-success";
      }
      
      // Prepare result
      const resultEl = document.getElementById('permissionResult');
      resultEl.className = `result show ${resultClass}`;
      
      resultEl.innerHTML = `
        <div style="margin-bottom: 10px;">
          <i class="fas fa-${resultClass.includes('danger') ? 'exclamation-triangle' : resultClass.includes('warning') ? 'question-circle' : 'check-circle'}"></i>
          <strong>${riskLevel} (${normalizedScore}/100)</strong>
        </div>
        <div style="font-size: 0.9rem;">
          <div>High Risk Permissions: ${highRiskCount}</div>
          <div>Medium Risk Permissions: ${mediumRiskCount}</div>
          <div>Low Risk Permissions: ${lowRiskCount}</div>
          <div style="margin-top: 10px;">Total Permissions: ${selectedPermissions.length}</div>
        </div>
      `;
      
      // Add explanation if high risk
      if (normalizedScore >= 70) {
        resultEl.innerHTML += `
          <div style="margin-top: 15px; font-size: 0.9rem;">
            <i class="fas fa-exclamation-circle"></i> This app requests several high-risk permissions. 
            Consider whether these permissions are necessary for the app's functionality.
          </div>
        `;
      }
    }

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
      // Set password strength meter color
      passwordStrengthMeter.style.backgroundColor = getMeterColor(0);
      
      // Add event listener for Enter key in inputs
      document.querySelectorAll('input').forEach(input => {
        input.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            const currentSection = document.querySelector('.section.active').id;
            if (currentSection === 'password') checkPassword();
            if (currentSection === 'phishing') checkPhishing();
            if (currentSection === 'login') checkLogin();
            if (currentSection === 'url') checkURL();
            if (currentSection === 'permissions') analyzePermissions();
          }
        });
      });
      
      // Initialize permission analyzer
      initPermissionAnalyzer();
    });
  </script>
</body>
</html>